<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Togglz Spring MVC Integration (under construction) by danichus</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Togglz Spring MVC Integration (under construction)</h1>
        <h2>Spring MVC Togglz Installation Guide</h2>
        <a href="https://github.com/danichus/Togglz" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a id="togglz-with-spring-mvc" class="anchor" href="#togglz-with-spring-mvc" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Togglz with Spring MVC</h1>

<p>A more in depth tutorial for how to integrate Togglz into simple Spring MVC web projects. This tutorial will more specifically be using the Spring Tools Suite (STS) IDE, however these instructions should be applicable to any Spring MVC project. In this tutorial we will create a simple HelloWorld Spring MVC project, and implement simple feature switches using <a href="https://togglz.org/">Togglz</a> in Java.</p>

<h3>
<a id="creating-hello-world-project" class="anchor" href="#creating-hello-world-project" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Creating Hello World Project</h3>

<ul>
<li>Open Spring Tools Suite</li>
<li>File -&gt; New -&gt; Spring Legacy Project -&gt; Spring MVC Project</li>
<li>Name project accordingly</li>
<li>Run project on server, localhost:8080/myapp should display Hello World by default</li>
</ul>

<h2>
<a id="adding-togglz-to-your-spring-mvc-project" class="anchor" href="#adding-togglz-to-your-spring-mvc-project" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Adding Togglz to your Spring MVC Project</h2>

<h3>
<a id="togglz-dependencies" class="anchor" href="#togglz-dependencies" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Togglz Dependencies</h3>

<p>In the project explorer, find the pom.xml file that should be under your project folder. Add the following dependencies to your pom.xml file. These are Maven dependencies that will be added to your project. The libraries related to your dependencies will be added to your project after they are built. In our Spring MVC, the togglz core, servlet, spring-web, and admin console dependencies are required. Please refer to <a href="https://togglz.org/">Togglz</a> for additional information. </p>

<pre><code>            &lt;!-- Togglz core module (mandatory) --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.togglz&lt;/groupId&gt;
        &lt;artifactId&gt;togglz-core&lt;/artifactId&gt;
        &lt;version&gt;2.3.0.RC1&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;!-- Togglz for Servlet environments (mandatory for webapps) --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.togglz&lt;/groupId&gt;
        &lt;artifactId&gt;togglz-servlet&lt;/artifactId&gt;
        &lt;version&gt;2.3.0.RC1&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;!-- Spring integration (optional) --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.togglz&lt;/groupId&gt;
        &lt;artifactId&gt;togglz-spring-web&lt;/artifactId&gt;
        &lt;version&gt;2.3.0.RC1&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;!-- Togglz Admin Console --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.togglz&lt;/groupId&gt;
        &lt;artifactId&gt;togglz-console&lt;/artifactId&gt;
        &lt;version&gt;2.3.0.RC1&lt;/version&gt;
    &lt;/dependency&gt;
</code></pre>

<h2>
<a id="togglz-configuration" class="anchor" href="#togglz-configuration" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Togglz Configuration</h2>

<p>After adding the dependencies to your project, you will have to add two additional files, MyFeatures.java and MyTogglzConfiguration.java. </p>

<h3>
<a id="myfeatures-enum" class="anchor" href="#myfeatures-enum" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>MyFeatures Enum</h3>

<p>Togglz are implemented as enums in Java. You will need to declare a MyFeatures enum and add this file to your project and format it accordingly.</p>

<pre><code>import org.togglz.core.Feature;
import org.togglz.core.annotation.EnabledByDefault;
import org.togglz.core.annotation.Label;
import org.togglz.core.context.FeatureContext;

public enum MyFeatures implements Feature {

 @EnabledByDefault
    @Label("First Feature")
    FEATURE_ONE,

    @Label("Second Feature")
    FEATURE_TWO;

    public boolean isActive() {
        return FeatureContext.getFeatureManager().isActive(this);
    }

}
</code></pre>

<p>@EnabledByDefault - these togglz will be enabled when the application runs
<a href="https://github.com/Label" class="user-mention">@Label</a> - the name of the feature</p>

<h3>
<a id="togglz-configuration-class" class="anchor" href="#togglz-configuration-class" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Togglz Configuration Class</h3>

<p>You will also need to create a Togglz configuration class. </p>

<pre><code>import java.io.File;

import org.springframework.stereotype.Component;
import org.togglz.core.Feature;
import org.togglz.core.manager.TogglzConfig;
import org.togglz.core.repository.StateRepository;
import org.togglz.core.repository.file.FileBasedStateRepository;
import org.togglz.core.user.FeatureUser;
import org.togglz.core.user.SimpleFeatureUser;
import org.togglz.core.user.UserProvider;

@Component
public class MyTogglzConfiguration implements TogglzConfig {
    public Class&lt;? extends Feature&gt; getFeatureClass() {
    return MyFeatures.class;
}

public StateRepository getStateRepository() {
    return new FileBasedStateRepository(new File("/tmp/features.properties"));
}

public UserProvider getUserProvider() {
     return new UserProvider() {
         @Override
         public FeatureUser getCurrentUser() {
             return new SimpleFeatureUser("admin", true);
         }
     };
}
}
</code></pre>

<p>getFeatureClass() - retrieve the Features from your Features enum
getStateRepository() - return the specified storage, in this case 
getUserProvider() - return the user at this instance of the application, in this case to make things simpler all instances will return that the user is an admin, this should not be used in production applications!!!</p>

<h3>
<a id="adjust-webxml" class="anchor" href="#adjust-webxml" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Adjust web.xml</h3>

<p>Lastly, in order for your application to run togglz correctly, there are a few things you need to add to the web.xml file in your project. </p>

<p>In order for Togglz to recognize your configuration class you need to add this context param, be especially careful of the param-value, and make sure it maps to your specified package and class name: com.my.app.MyTogglzConfiguration</p>

<pre><code>   &lt;context-param&gt;
    &lt;param-name&gt;org.togglz.core.manager.TogglzConfig&lt;/param-name&gt;
    &lt;param-value&gt;com.my.app.MyTogglzConfiguration&lt;/param-value&gt;
&lt;/context-param&gt;
</code></pre>

<p>Togglz will have to be specified whether or not the Feature Manager is provided, since we are working with a Spring MVC application, we need to specify that this is false</p>

<pre><code>&lt;context-param&gt;
    &lt;param-name&gt;org.togglz.FEATURE_MANAGER_PROVIDED&lt;/param-name&gt;
    &lt;param-value&gt;false&lt;/param-value&gt;
&lt;/context-param&gt;
</code></pre>

<p>If you are working in a Servlet environment 2.5 or earlier you will have to add this to your web.xml</p>

<pre><code>    &lt;!-- Togglz configuration for Servlet 2.5 and earlier --&gt;
&lt;filter&gt;
    &lt;filter-name&gt;TogglzFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;org.togglz.servlet.TogglzFilter&lt;/filter-class&gt;
&lt;/filter&gt;
&lt;filter-mapping&gt;
    &lt;filter-name&gt;TogglzFilter&lt;/filter-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;
</code></pre>

<p>Lastly, the console servlet is added in order to properly configure the admin console.</p>

<pre><code>    &lt;servlet&gt;
    &lt;servlet-name&gt;TogglzConsoleServlet&lt;/servlet-name&gt;
    &lt;servlet-class&gt;org.togglz.console.TogglzConsoleServlet&lt;/servlet-class&gt;
&lt;/servlet&gt;
&lt;servlet-mapping&gt;
    &lt;servlet-name&gt;TogglzConsoleServlet&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/togglz/*&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;
</code></pre>

<h3>
<a id="test-the-togglz-admin-console" class="anchor" href="#test-the-togglz-admin-console" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Test the Togglz Admin Console</h3>

<p>Build and run your project, and go to localhost:8080/myapp/togglz, and the admin console should appear if you have integrated togglz into your application correctly. </p>

<h3>
<a id="support-or-contact" class="anchor" href="#support-or-contact" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Support or Contact</h3>

<p>TBD</p>

<h3>
<a id="to-do" class="anchor" href="#to-do" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>TO DO:</h3>

<p>-added togglz jdbc capability</p>

<ul>
<li>added caching state repository ability</li>
<li>set up google cloud platform to host mysql server</li>
<li>access mysql server from jdbc driver in application</li>
<li>multiple machines can access the togglz database from the hello world application </li>
</ul>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/danichus/Togglz/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/danichus/Togglz/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/danichus/Togglz"></a> is maintained by <a href="https://github.com/danichus">danichus</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>
