<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Togglz Spring MVC Integration by danichus</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Togglz Spring MVC Integration</h1>
      <h2 class="project-tagline">Spring MVC Togglz Installation Guide</h2>
      <a href="https://github.com/danichus/Togglz" class="btn">View on GitHub</a>
      <a href="https://github.com/danichus/Togglz/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/danichus/Togglz/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="togglz-with-spring-mvc" class="anchor" href="#togglz-with-spring-mvc" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Togglz with Spring MVC</h1>

<p>A more in depth tutorial for how to integrate Togglz into simple Spring MVC web projects. This tutorial will more specifically be using the Spring Tools Suite (STS) IDE, however these instructions should be applicable to any Spring MVC project. In this tutorial we will create a simple HelloWorld Spring MVC project, and implement simple feature switches using <a href="https://togglz.org/">Togglz</a> in Java.</p>

<h3>
<a id="dependencies-in-pomxml-file" class="anchor" href="#dependencies-in-pomxml-file" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Dependencies in pom.xml file</h3>

<pre><code>            &lt;!-- Togglz core module (mandatory) --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.togglz&lt;/groupId&gt;
        &lt;artifactId&gt;togglz-core&lt;/artifactId&gt;
        &lt;version&gt;2.3.0.RC1&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;!-- Togglz for Servlet environments (mandatory for webapps) --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.togglz&lt;/groupId&gt;
        &lt;artifactId&gt;togglz-servlet&lt;/artifactId&gt;
        &lt;version&gt;2.3.0.RC1&lt;/version&gt;
    &lt;/dependency&gt;

    &lt;!-- Spring integration (optional) --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.togglz&lt;/groupId&gt;
        &lt;artifactId&gt;togglz-spring-web&lt;/artifactId&gt;
        &lt;version&gt;2.3.0.RC1&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;!-- Togglz Admin Console --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.togglz&lt;/groupId&gt;
        &lt;artifactId&gt;togglz-console&lt;/artifactId&gt;
        &lt;version&gt;2.3.0.RC1&lt;/version&gt;
    &lt;/dependency&gt;
</code></pre>

<h3>
<a id="myfeatures-enum" class="anchor" href="#myfeatures-enum" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>MyFeatures Enum</h3>

<p>import org.togglz.core.Feature;
import org.togglz.core.annotation.EnabledByDefault;
import org.togglz.core.annotation.Label;
import org.togglz.core.context.FeatureContext;</p>

<p>public enum MyFeatures implements Feature {</p>

<pre><code> @EnabledByDefault
    @Label("First Feature")
    FEATURE_ONE,

    @Label("Second Feature")
    FEATURE_TWO;

    public boolean isActive() {
        return FeatureContext.getFeatureManager().isActive(this);
    }
</code></pre>

<p>}</p>

<h3>
<a id="togglz-configuration-class" class="anchor" href="#togglz-configuration-class" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Togglz Configuration Class</h3>

<p>import java.io.File;</p>

<p>import org.springframework.stereotype.Component;
import org.togglz.core.Feature;
import org.togglz.core.manager.TogglzConfig;
import org.togglz.core.repository.StateRepository;
import org.togglz.core.repository.file.FileBasedStateRepository;
import org.togglz.core.user.FeatureUser;
import org.togglz.core.user.SimpleFeatureUser;
import org.togglz.core.user.UserProvider;</p>

<p><a href="https://github.com/Component" class="user-mention">@Component</a>
public class MyTogglzConfiguration implements TogglzConfig {
    public Class&lt;? extends Feature&gt; getFeatureClass() {
        return MyFeatures.class;
    }</p>

<pre><code>public StateRepository getStateRepository() {
    return new FileBasedStateRepository(new File("/tmp/features.properties"));
}

public UserProvider getUserProvider() {
     return new UserProvider() {
         @Override
         public FeatureUser getCurrentUser() {
             return new SimpleFeatureUser("admin", true);
         }
     };
    //String user = HttpServletRequest.getUserPrincipal().getName();
    //return new ServletUserProvider("admin");
}
</code></pre>

<p>}</p>

<h3>
<a id="webxml" class="anchor" href="#webxml" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Web.xml</h3>

<pre><code>   &lt;context-param&gt;
    &lt;param-name&gt;org.togglz.core.manager.TogglzConfig&lt;/param-name&gt;
    &lt;param-value&gt;com.my.app.MyTogglzConfiguration&lt;/param-value&gt;
&lt;/context-param&gt;

&lt;context-param&gt;
    &lt;param-name&gt;org.togglz.FEATURE_MANAGER_PROVIDED&lt;/param-name&gt;
    &lt;param-value&gt;false&lt;/param-value&gt;
&lt;/context-param&gt;

    &lt;!-- Togglz configuration for Servlet 2.5 and earlier --&gt;
&lt;filter&gt;
    &lt;filter-name&gt;TogglzFilter&lt;/filter-name&gt;
    &lt;filter-class&gt;org.togglz.servlet.TogglzFilter&lt;/filter-class&gt;
&lt;/filter&gt;
&lt;filter-mapping&gt;
    &lt;filter-name&gt;TogglzFilter&lt;/filter-name&gt;
    &lt;url-pattern&gt;/*&lt;/url-pattern&gt;
&lt;/filter-mapping&gt;

    &lt;servlet&gt;
    &lt;servlet-name&gt;TogglzConsoleServlet&lt;/servlet-name&gt;
    &lt;servlet-class&gt;org.togglz.console.TogglzConsoleServlet&lt;/servlet-class&gt;
&lt;/servlet&gt;
&lt;servlet-mapping&gt;
    &lt;servlet-name&gt;TogglzConsoleServlet&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/togglz/*&lt;/url-pattern&gt;
&lt;/servlet-mapping&gt;
</code></pre>

<h3>
<a id="support-or-contact" class="anchor" href="#support-or-contact" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Support or Contact</h3>

<p>TBD</p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/danichus/Togglz">Togglz Spring MVC Integration</a> is maintained by <a href="https://github.com/danichus">danichus</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
